<section [formGroup]="form">
  <div *ngFor="let filter of calendarFilters">
    <mat-form-field>
      <input
        type="text"
        [placeholder]="filter.display_name"
        matInput
        [matAutocomplete]="auto"
        [formControlName]="filter.id"
      />
      <mat-hint
        >{{ filter.selectedItems.length }} {{ filter.display_name }} selected
        <span
          class="clear"
          *ngIf="filter.selectedItems.length > 0"
          (click)="clearFilters(filter)"
        ><mat-icon>cancel</mat-icon>Clear</span
        ></mat-hint
      >
    </mat-form-field>

    <mat-autocomplete #auto="matAutocomplete" [displayWith]="filter.displayFn">
      <mat-option
        *ngFor="let filterItem of filter.filtereditems | async"
        [value]="filterItem"
      >
        <div (click)="selected($event, filterItem, filter)">
          <mat-checkbox
            [checked]="filterItem.selected"
            (change)="toggleSelection(filterItem, filter)"
            (click)="$event.stopPropagation()"
          >
            {{ filterItem.title }}
          </mat-checkbox>
        </div>
      </mat-option>
    </mat-autocomplete>

    <!-- <mat-form-field class="example-chip-list">
      <mat-chip-list #chipList aria-label="Fruit selection">
        <mat-chip
          *ngFor="let selectedFilter of filter.selectedItems"
          [selectable]="true"
          [removable]="true"
          (removed)="remove(selectedFilter, filter)">
          {{ selectedFilter.title }}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
        <input
          [placeholder]="filter.display_name"
          #fruitInput
          [formControlName]="filter.id"
          [matAutocomplete]="auto"
          [matChipInputFor]="chipList"
          [matChipInputAddOnBlur]="false">
      </mat-chip-list>
      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event, filter)">
        <mat-option *ngFor="let filterItem of filter.filtereditems | async" [value]="filterItem">
          {{ filterItem.title }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field> -->
  </div>
</section>
